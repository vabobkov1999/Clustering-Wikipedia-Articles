
# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ4



| üî¢  | –•–æ–¥ —Ä–∞–±–æ—Ç—ã   | ‚ÑπÔ∏è |
| ------------- | ------------- |------------- |
| 1Ô∏è‚É£  | –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ wikipedia, scipy.| ‚úÖ |
| 2Ô∏è‚É£ | –ù–∞–π—Ç–∏ —Å–ø–∏—Å–æ–∫ —Å—Ç–∞—Ç–µ–π –∞–Ω–≥–ª–æ—è–∑—ã—á–Ω–æ–π –í–∏–∫–∏–ø–µ–¥–∏–∏ –ø–æ —Ç–µ–º–∞–º —Å–æ–≥–ª–∞—Å–Ω–æ –≤–∞—Ä–∏–∞–Ω—Ç—É (–º–∏–Ω–∏–º—É–º 15 —Å—Ç–∞—Ç–µ–π –ø–æ –∫–∞–∂–¥–æ–π —Ç–µ–º–µ) –∏ –∑–∞–ø–∏—Å–∞—Ç—å –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–∞—Å—Å–∏–≤. |‚úÖ  |
| 3Ô∏è‚É£ | 	–ü–æ–ª—É—á–∏—Ç—å —Ç–µ—Å—Ç —Å—Ç–∞—Ç–µ–π (–¥–æ–∫—É–º–µ–Ω—Ç) –∏ –∑–∞–ø–∏—Å–∞—Ç—å –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–∞—Å—Å–∏–≤.|‚úÖ  |
| 4Ô∏è‚É£ |*	–ò–∑–≤–ª–µ—á—å —Ñ–∏—á–∏ –∏–∑ —Ç–µ–∫—Å—Ç–æ–≤ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º —è–∑—ã–∫–µ —Å –ø–æ–º–æ—â—å—é TF-IDF (–ø—Ä–∏–∑–Ω–∞–∫–∏). |‚úÖ  |
| 5Ô∏è‚É£ | –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —á–∏—Å–ª–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ —Å –ø–æ–º–æ—â—å elbow –º–µ—Ç–æ–¥–∞ –∏ –Ω–∞—Ä–∏—Å–æ–≤–∞—Ç—å –≥—Ä–∞—Ñ–∏–∫. |‚úÖ  |
| 6Ô∏è‚É£ | –†–∞–∑–±–∏—Ç—å –º–∞—Å—Å–∏–≤ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –Ω–∞ –∫–ª–∞—Å—Ç–µ—Ä—ã —Å –ø–æ–º–æ—â—å—é –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ KMeans, MiniBatchKMeans, DBSCAN –∏ –≤—ã–≤–µ—Å—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞–±–æ—Ç—ã –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –≤ –∫–æ–Ω—Å–æ–ª—å. |‚úÖ  |
| 7Ô∏è‚É£ | –†–∞–∑–±–∏—Ç—å –º–∞—Å—Å–∏–≤ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –Ω–∞ –∫–ª–∞—Å—Ç–µ—Ä—ã —Å –ø–æ–º–æ—â—å—é –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–æ–π –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ (–∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ scipy) –∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –≤–∏–¥–µ –¥–µ–Ω–¥—Ä–æ–≥—Ä–∞–º–º—ã.|‚úÖ  |


–¶–µ–ª—å —Ä–∞–±–æ—Ç—ã
------------
–° –ø–æ–º–æ—â—å—é python3.8 —Å–æ–∑–¥–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—ã –¥–ª—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ —Å—Ç–∞—Ç–µ–π Wikipedia.

–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã
-----------------

–ú—ã —Å–æ–±–∏—Ä–∞–µ–º—Å—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–æ–≤–∞—Ç—å —Å—Ç–∞—Ç—å–∏ –í–∏–∫–∏–ø–µ–¥–∏–∏, –∏—Å–ø–æ–ª—å–∑—É—è –∞–ª–≥–æ—Ä–∏—Ç–º k-—Å—Ä–µ–¥–Ω–∏—Ö. –î–ª—è —ç—Ç–æ–≥–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è:

1. –Ω–∞–π—Ç–∏ —Å—Ç–∞—Ç—å–∏ –∏–∑ –í–∏–∫–∏–ø–µ–¥–∏–∏
2. –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∂–¥—É—é —Å—Ç–∞—Ç—å—é –≤ –≤–∏–¥–µ –≤–µ–∫—Ç–æ—Ä–∞
3. –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—é k-—Å—Ä–µ–¥–Ω–∏—Ö
4. –û—Ü–µ–Ω–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç—å–∏ –∏–∑ Wikipedia –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—è –ø–∞–∫–µ—Ç "wikipedia".

### –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—å–µ–π –≤ –≤–∏–¥–µ –≤–µ–∫—Ç–æ—Ä–∞.

–ü–æ—Å–∫–æ–ª—å–∫—É –º—ã —Å–æ–±–∏—Ä–∞–µ–º—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å k-means, –Ω–∞–º –Ω—É–∂–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∂–¥—É—é —Å—Ç–∞—Ç—å—é –∫–∞–∫ —á–∏—Å–ª–æ–≤–æ–π –≤–µ–∫—Ç–æ—Ä. –ü–æ–ø—É–ª—è—Ä–Ω—ã–π –º–µ—Ç–æ–¥ - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ—Ä–º–∏–Ω-—á–∞—Å—Ç–æ—Ç–∞ / –æ–±—Ä–∞—Ç–Ω–∞—è-—á–∞—Å—Ç–æ—Ç–∞-–¥–æ–∫—É–º–µ–Ω—Ç–∞ (tf-idf). –ü—Ä–æ—â–µ –≥–æ–≤–æ—Ä—è, —Å –ø–æ–º–æ—â—å—é —ç—Ç–æ–≥–æ –º–µ—Ç–æ–¥–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–ª–æ–≤–∞ w –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞ d –º—ã –≤—ã—á–∏—Å–ª—è–µ–º:

* tf (w, d): –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ—è–≤–ª–µ–Ω–∏–π —Å–ª–æ–≤–∞ w –≤ d –∫ –æ–±—â–µ–º—É –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —Å–ª–æ–≤ –≤ d.
* idf (w): –ª–æ–≥–∞—Ä–∏—Ñ–º –¥–æ–ª–∏ –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, –¥–µ–ª–µ–Ω–Ω–æ–π –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, —Å–æ–¥–µ—Ä–∂–∞—â–∏—Ö w.
* tf-idf (w, d) = tf (w, d) x idf (w)

–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–∫–ª—é—á–∏—Ç—å –æ–±—â–∏–µ —Å—Ç–æ–ø-—Å–ª–æ–≤–∞. –í—Å–µ —Ä–∞—Å—á–µ—Ç—ã –ª–µ–≥–∫–æ –≤—ã–ø–æ–ª–Ω–∏–º —Å –ø–æ–º–æ—â—å—é [TfidfVectorizer –æ—Ç sklearn](https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.TfidfVectorizer.html).–î–ª—è —ç—Ç–æ–≥–æ —Å–æ–∑–¥–∞–µ–º –º–æ–¥–µ–ª—å —Å–æ —Å—Ç–æ–ø-—Å–ª–æ–≤–æ–º "english" (–º–∞—Å—Å–∏–≤ —Å—Ç–∞—Ç–µ–π —Å–æ—Å—Ç–æ—è—â–∏—Ö –∏–∑ –±–æ–ª—å—à–æ–≥–æ —á–∏—Å–ª–∞ —Å–ª–æ–≤, –º—ã –ø–µ—Ä–µ–≤–æ–¥–∏–º –∏—Ö –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è —Ñ–∏—Ç—á), –Ω–∏–∂–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω —Ñ—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞.

```python
model = TfidfVectorizer(stop_words={'english'})
```

–î–∞–ª–µ–µ –∑–∞–±–∏–≤–∞–µ–º –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –º–æ–¥–µ–ª—å fit_transform(–ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –≤ —á–∏—Å–ª–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ). –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –ø–æ–ª—É—á–∞–µ–º –≤–µ–∫—Ç–æ—Ä –• –≤ –∫–æ—Ç–æ—Ä–æ–º –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –º–∞—Å—Å–∏–≤ —Å—Ç–∞—Ç–µ–π –∏ –∫–æ—Ç–æ—Ä—ã–π —è–≤–ª—è–µ—Ç—Å—è –≤–µ–∫—Ç–æ—Ä–æ–º —Ñ–∏—Ç—á.

```python
X = model.fit_transform(text_from_wiki)
```

### –ü—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤

–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ –≤–æ—Å–ø–æ–ª—å–∑—É–µ–º—Å—è  Elbow –º–µ—Ç–æ–¥–æ–º. –°—É—Ç—å –º–µ—Ç–æ–¥–∞ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ –Ω—É–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤, —á—Ç–æ–±—ã –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –µ—â–µ –æ–¥–Ω–æ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞ –Ω–µ –¥–∞–ª–æ –ª—É—á—à–µ–≥–æ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö. –ë–µ—Ä—ë–º —á–∏—Å–ª–æ –æ—Ç 2 –¥–æ 8 –ø–æ –ø–æ—Ä—è–¥–∫—É, —Å–æ–∑–¥–∞–µ–º –º–æ–¥–µ–ª—å KMeans, —Å –ø–æ–º–æ—â—å—é –Ω–µ—ë –º—ã –Ω–∞—Ö–æ–¥–∏–º –≤–µ—Å–æ–≤–æ–π —Ü–µ–Ω—Ç—Ä –∏ —ç—Ç–æ—Ç –º–µ—Ç–æ–¥ –ø–µ—Ä–µ–¥–≤–∏–≥–∞–µ—Ç –≤ –ª—É—á—à—É—é –ø–æ–∑–∏—Ü–∏—é, —Å –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–µ–π –¥–æ–±–∞–≤–ª—è—è –∫–∞–∫–∏–µ-—Ç–æ –Ω—É–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ —É–±–∏—Ä–∞—è –ª–∏—à–Ω–∏–µ. max_iter - —á–∏—Å–ª–æ –∏—Ç–µ—Ä–∞—Ü–∏–π –∫–æ—Ç–æ—Ä–æ–µ –æ–Ω –±—É–¥–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å.

```python
clusters = range(2, 8) # –º–∞—Å—Å–∏–≤ —Å–æ—Å—Ç–æ—è—â–∏–π –∏–∑ —á–∏—Å–µ–ª –æ—Ç 2 –¥–æ 8
tmp = []
for x in clusters:
    model = KMeans(n_clusters=x, init='k-means++', n_init=10, max_iter=200)# c –ø–æ–º–æ—â—å—é –µ—ë —Å—Ç—Ä–æ–∏–º Elbow –∫—Ä–∏–≤—É—é
    Y = model.fit(X)
    tmp.append(Y.inertia_)
```
### –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –º–µ—Ç–æ–¥–æ–º k-means
–í—ã–ø–æ–ª–Ω–∏–º –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—é —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ k-means.
–ü–ª—é—Å–∞–º–∏ —ç—Ç–æ–≥–æ –º–µ—Ç–æ–¥–∞ —è–≤–ª—è—é—Ç—Å—è:
* –ø—Ä–æ—Å—Ç–æ—Ç–∞,
* —Å–∫–æ—Ä–æ—Å—Ç—å
* –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
* —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
* —Ä–∞–±–æ—Ç–∞ —Å –±–æ–ª—å—à–∏–º–∏ –æ–±—ä–µ–º–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö

–ö–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π X —è–≤–ª—è–µ—Ç—Å—è –≤–µ–∫—Ç–æ—Ä–Ω—ã–º –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ–º —Å—Ç–∞—Ç—å–∏ –≤ –í–∏–∫–∏–ø–µ–¥–∏–∏. –°–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å X –≤ –∫–∞—á–µ—Å—Ç–≤–µ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞ k-means.

#### –§—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞ —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –º–µ—Ç–æ–¥ k-means
```python
print ('\n', "KMeans method", '\n')
clusters = 3
model = KMeans(n_clusters=clusters, init='k-means++', n_init=10, max_iter=200)
model.fit(X)
labels = model.labels_
clusters_kmeans = pd.DataFrame(list(zip(data, labels)), columns=['title', 'cluster'])
print(clusters_kmeans)
```

### –î–µ—Ä–µ–≤–æ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏

–° –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ hierarchy –ø–æ—Å—Ç—Ä–æ–∏–º –¥–µ—Ä–µ–≤–æ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏. –°—É—Ç—å –º–µ—Ç–æ–¥–∞ —Å–æ—Å—Ç–æ–∏—Ç –≤ —Ç–æ–º, —á—Ç–æ –æ–Ω –±–µ—Ä–µ—Ç –Ω–∞ –ø–µ—Ä–≤–æ–º —ç—Ç–∞–ø–µ –∫–∞–∂–¥—É—é –ø–∞—Ä—É –∏ —Å–º–æ—Ç—Ä–∏—Ç, –∫–∞–∫–∞—è  –∏–∑ –Ω–∏—Ö –±–ª–∏–∂–µ –≤—Å–µ–≥–æ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –∏ –∑–∞–ø–∏—Ö–∏–≤–∞–µ—Ç –≤ –æ–¥–∏–Ω –∫–ª–∞—Å—Ç–µ—Ä, –ø–æ—Ç–æ–º –ø—ã—Ç–∞–µ—Ç—Å—è —Å–æ–≤–º–µ—Å—Ç–∏—Ç—å –ø–∞—Ä—ã –∫–ª–∞—Å—Ç–µ—Ä–æ–≤, –≤–æ–∑–º–æ–∂–Ω–æ —á—Ç–æ –Ω–∏ –æ–¥–Ω–∞ –ø–∞—Ä–∞ –Ω–µ —Å–æ–≤–º–µ—Å—Ç–∏—Ç—Å—è, —Ç–æ–≥–¥–∞ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∫–ª–∞—Å—Å–∞ –æ—Å—Ç–∞–≤–ª—è–µ—Ç –æ–¥–∏–Ω —ç–ª–µ–º–µ–Ω—Ç.

#### –§—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥–∞ –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–π –º–µ—Ç–æ–¥ hierarchy
```python
samples = X.toarray()
mergings = linkage(samples, method='ward')
dendrogram(mergings, labels=data, leaf_font_size=5, orientation='right')
plt.show()
```

–†–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã:
---------------------------------

#### k-means –≥—Ä–∞—Ñ–∏–∫ –∏ —Å–ø–∏—Å–æ–∫:


![Gitlab logo](https://bmstu.codes/MorozoFF/lr-4-opc/-/raw/master/g-H4jagE6Ds.jpg)

<p align="center">
  <img src="https://bmstu.codes/MorozoFF/lr-4-opc/-/raw/master/_-fzoGz5yo8.jpg" />
</p>


#### –ú–µ—Ç–æ–¥ hierarchy:

![Gitlab logo](https://bmstu.codes/MorozoFF/lr-4-opc/-/raw/master/nQcsivJLEDM.jpg)

–¢–∞–∫ –∂–µ –Ω–∞–ø–æ–º–∏–Ω–∞—é –¥–ª—è —Ç–µ—Ö –∫–æ–º—É –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ —Å–∞–º–æ–º—É –∏–ª–∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É, —Ç–æ –ø—Ä–æ—à—É –ø–µ—Ä–µ–π—Ç–∏ [—Å—é–¥–∞](https://drive.google.com/drive/folders/1b_molbj8z6JhHV6r178AeI1XpQezehsm?usp=sharing "–ü—Ä–∞–∫—Ç–∏–∫—É–º –ø–æ –º–∞—à–∏–Ω–Ω–æ–º—É –æ–±—É—á–µ–Ω–∏—é")
